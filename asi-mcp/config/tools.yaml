# MCP Security Training Server Configuration
# Educational security testing tools - Authorized use only

# Security Settings
security:
  # Authorized networks for scanning (CIDR notation)
  # For training environments with authorized public targets (like PortSwigger, HTB, etc.),
  # leave this empty to allow all IPs (except blacklisted ones)
  # To restrict to private networks only, uncomment the lines below:
  authorized_networks: []
    # - "10.0.0.0/8"       # Private network range A
    # - "172.16.0.0/12"    # Private network range B
    # - "192.168.0.0/16"   # Private network range C

  # Blacklisted networks (never scan these)
  blacklisted_networks:
    - "127.0.0.0/8"      # Loopback
    - "169.254.0.0/16"   # Link-local
    - "224.0.0.0/4"      # Multicast
    - "240.0.0.0/4"      # Reserved

  # Authorized domains for web testing
  # For training environments, include legitimate pentesting labs and CTF platforms
  authorized_domains:
    # PortSwigger Web Security Academy
    - "ginandjuice.shop"
    - "portswigger.net"
    - "web-security-academy.net"

    # HackTheBox
    - "htb"
    - "hackthebox.eu"
    - "hackthebox.com"

    # TryHackMe
    - "tryhackme.com"

    # PentesterLab
    - "pentesterlab.com"

    # VulnHub / Local labs
    - "vulnhub.local"
    - "example-training.local"
    - "lab.training.com"

    # Add your custom training domains here

# Tool Configurations
tools:
  # Network Reconnaissance Tools
  nmap:
    enabled: true
    max_concurrent: 3
    timeout_seconds: 600
    default_args: "-T4 --max-rate 1000"
    rate_limit_per_minute: 10

  masscan:
    enabled: true
    max_concurrent: 2
    timeout_seconds: 600
    default_rate: 1000
    max_rate: 10000

  rustscan:
    enabled: true
    max_concurrent: 3
    timeout_seconds: 300
    default_ulimit: 5000

  subfinder:
    enabled: true
    timeout_seconds: 300
    default_sources: "all"

  nuclei:
    enabled: true
    max_concurrent: 2
    timeout_seconds: 600
    default_severity: "medium,high,critical"
    template_update_interval: 86400  # 24 hours

  theharvester:
    enabled: true
    timeout_seconds: 300
    default_sources: "google,bing,linkedin"
    default_limit: 500

  # Web Application Security Tools
  gobuster:
    enabled: true
    max_concurrent: 3
    timeout_seconds: 600
    default_threads: 10
    default_wordlist: "/usr/share/dirb/wordlists/common.txt"

  nikto:
    enabled: true
    max_concurrent: 2
    timeout_seconds: 600

  sqlmap:
    enabled: true
    max_concurrent: 1
    timeout_seconds: 900
    default_level: 1
    default_risk: 1

  wpscan:
    enabled: true
    timeout_seconds: 600
    default_enumerate: "vp,vt,u"

  ffuf:
    enabled: true
    max_concurrent: 3
    timeout_seconds: 600
    default_wordlist: "/usr/share/wordlists/common.txt"

  httpx:
    enabled: true
    timeout_seconds: 300

  wafw00f:
    enabled: true
    timeout_seconds: 120

  # Cloud Security Tools
  prowler:
    enabled: true
    timeout_seconds: 1800
    default_provider: "aws"

  scoutsuite:
    enabled: true
    timeout_seconds: 1800

  # Binary Analysis Tools
  strings:
    enabled: true
    timeout_seconds: 120
    default_min_length: 4

  binwalk:
    enabled: true
    timeout_seconds: 300

  radare2:
    enabled: true
    timeout_seconds: 300

  # Exploitation Tools
  hydra:
    enabled: true
    max_concurrent: 1
    timeout_seconds: 900
    default_wordlist: "/usr/share/wordlists/rockyou.txt"

  hashcat:
    enabled: true
    max_concurrent: 1
    timeout_seconds: 1800

  john:
    enabled: true
    max_concurrent: 1
    timeout_seconds: 1800

  crackmapexec:
    enabled: true
    timeout_seconds: 600

# Rate Limiting
rate_limits:
  # Global rate limits
  requests_per_minute: 30
  requests_per_hour: 500
  concurrent_scans: 5

  # Per-tool rate limits (overrides global)
  per_tool:
    nmap: 10
    masscan: 5
    sqlmap: 3

# Logging Configuration
logging:
  level: "INFO"
  format: "json"
  audit_enabled: true
  audit_log_path: "/app/logs/audit.log"
  server_log_path: "/app/logs/server.log"
  rotation:
    max_bytes: 104857600  # 100MB
    backup_count: 10

# Wordlists
wordlists:
  directory:
    - "/usr/share/wordlists/common.txt"
    - "/usr/share/wordlists/directory-list-small.txt"
  passwords:
    - "/usr/share/wordlists/rockyou.txt"
  usernames:
    - "/usr/share/wordlists/usernames.txt"

# Educational Settings
training:
  banner_enabled: true
  disclaimer_text: |
    ╔═══════════════════════════════════════════════════════════╗
    ║   AUTHORIZED SECURITY TRAINING ENVIRONMENT ONLY           ║
    ║   All activities are logged and monitored                 ║
    ║   For educational purposes - Black Hills InfoSec         ║
    ╚═══════════════════════════════════════════════════════════╝

  # Require explicit consent
  require_consent: false

# Performance Tuning
performance:
  max_workers: 10
  timeout_default: 300
  memory_limit_mb: 4096
